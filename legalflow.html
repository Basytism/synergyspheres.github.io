<!-- LegalFlow Intro Section Before Launch -->
<section class="bg-gray-900 py-20 px-6 border-t border-gray-700">
  <div class="max-w-5xl mx-auto text-center text-white">
    <h2 class="text-3xl font-bold font-orbitron mb-6" data-aos="fade-up">üîê Introducing LegalFlow Contract Suite</h2>
    <p class="text-gray-300 mb-6" data-aos="fade-up" data-aos-delay="100">
      Experience a seamless contract management system ‚Äî powered by <strong class="text-indigo-400">Synergy Spheres 3.0</strong>. Built for legal professionals, freelancers, and startups who want control, compliance, and clarity in one place.
    </p>
    <div class="flex justify-center space-x-4" data-aos="fade-up" data-aos-delay="200">
      <a href="#legalflow-tool" class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-full font-semibold transition transform hover:scale-105 shadow-md">
        üöÄ Start Using LegalFlow
      </a>
      <a href="https://synergyspheres.gumroad.com/l/legalflow-suite" target="_blank" class="text-indigo-300 underline text-sm mt-3">
        View Full Product Details
      </a>
    </div>
  </div>
</section>

<!-- LegalFlow Tool Main Contract Form -->
<section id="legalflow-tool" class="bg-gray-800 py-16 px-6 border-t border-gray-700">
  <div class="max-w-5xl mx-auto text-white">
    <h3 class="text-2xl font-bold font-orbitron mb-6">‚úçÔ∏è Draft Your Contract</h3>
    <form id="contractForm" class="space-y-6">
      <div>
        <label for="partyA" class="block text-sm font-medium mb-1">Party A Name</label>
        <input type="text" id="partyA" name="partyA" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600" required>
      </div>
      <div>
        <label for="partyB" class="block text-sm font-medium mb-1">Party B Name</label>
        <input type="text" id="partyB" name="partyB" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600" required>
      </div>
      <div>
        <label for="contractDate" class="block text-sm font-medium mb-1">Date of Agreement</label>
        <input type="date" id="contractDate" name="contractDate" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600">
      </div>
      <div>
        <label for="editableClauses" class="block text-sm font-medium mb-1">Editable Clauses</label>
        <textarea id="editableClauses" rows="8" class="w-full p-4 rounded bg-gray-700 text-white border border-indigo-500" placeholder="Type or paste your clauses here..."></textarea>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Upload Supporting Document (Optional)</label>
        <input type="file" accept=".doc,.docx,.pdf,.txt" onchange="handleFileUpload(event)" class="text-sm">
      </div>

      <!-- Clause Library -->
      <div class="bg-gray-700 rounded p-4 border border-indigo-400">
        <h4 class="font-orbitron text-lg mb-3">üìö Clause Library (Drag to Insert)</h4>
        <div id="clauseLibrary" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          <div class="bg-gray-600 p-2 rounded cursor-pointer" draggable="true" ondragstart="dragClause(event)">Confidentiality: Both parties agree to keep all terms private.</div>
          <div class="bg-gray-600 p-2 rounded cursor-pointer" draggable="true" ondragstart="dragClause(event)">Termination: Either party may terminate with 30 days notice.</div>
          <div class="bg-gray-600 p-2 rounded cursor-pointer" draggable="true" ondragstart="dragClause(event)">Dispute Resolution: All disputes shall be settled via arbitration.</div>
        </div>
      </div>

      <!-- Signature Block -->
      <div class="grid grid-cols-2 gap-4 mt-6">
        <div>
          <label class="block text-sm font-medium mb-1">Party A Signature</label>
          <input type="text" placeholder="Signature" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Party B Signature</label>
          <input type="text" placeholder="Signature" class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600">
        </div>
      </div>

      <div class="flex space-x-4 mt-6">
        <button type="button" onclick="exportPDF()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded font-semibold transition">üìÑ Export as PDF</button>
        <button type="reset" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded font-semibold transition">üîÑ Reset</button>
      </div>
    </form>
  </div>
</section>

<!-- Firebase Collaboration Integration Placeholder -->
<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js';
  import { getDatabase, ref, set, onValue } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js';

  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID",
    databaseURL: "https://YOUR_PROJECT.firebaseio.com"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const clauseRef = ref(db, 'legalflow/clause');

  const clauseInput = document.getElementById('editableClauses');

  clauseInput.addEventListener('input', () => {
    set(clauseRef, clauseInput.value);
  });

  onValue(clauseRef, (snapshot) => {
    if (document.activeElement !== clauseInput) {
      clauseInput.value = snapshot.val();
    }
  });
</script>

<script>
function dragClause(e) {
  e.dataTransfer.setData("text/plain", e.target.innerText);
}

document.getElementById("editableClauses").addEventListener("dragover", (e) => e.preventDefault());
document.getElementById("editableClauses").addEventListener("drop", (e) => {
  e.preventDefault();
  const text = e.dataTransfer.getData("text/plain");
  const textarea = e.target;
  const start = textarea.selectionStart;
  const end = textarea.selectionEnd;
  textarea.value = textarea.value.substring(0, start) + text + textarea.value.substring(end);
});

async function handleFileUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = async () => {
    const content = reader.result.slice(0, 10000);
    document.getElementById('filePreview').textContent = content.slice(0, 1000) + '\n...';
    alert('File uploaded successfully. Attempting to detect clauses...');

    try {
      const response = await fetch('https://api.openai.com/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer YOUR_OPENAI_API_KEY'
        },
        body: JSON.stringify({
          model: 'gpt-4',
          messages: [{ role: 'user', content: `Extract legal clauses from this contract:\n\n${content}` }]
        })
      });
      const result = await response.json();
      const aiOutput = result.choices[0]?.message?.content || 'No response';
      document.getElementById('editableClauses').value += "\n\nüìå AI Suggestions:\n" + aiOutput;
    } catch (error) {
      console.error('AI API failed:', error);
    }
  };
  reader.readAsText(file);
}

function exportPDF() {
  const element = document.getElementById('legalflow-tool');
  const opt = {
    margin: 0.5,
    filename: 'LegalFlow_Contract.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
  };
  html2pdf().from(element).set(opt).save();
}
</script>

<!-- File Preview Section -->
<section class="bg-gray-900 py-8 px-6">
  <div class="max-w-4xl mx-auto">
    <h4 class="text-lg text-white font-orbitron mb-2">üìÇ File Preview</h4>
    <pre id="filePreview" class="bg-gray-800 text-green-300 p-4 rounded border border-indigo-400 overflow-auto text-sm" style="max-height: 300px"></pre>
  </div>
</section>
